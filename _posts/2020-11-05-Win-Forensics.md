---
title: "Windows Forensic Notes, Cheatsheet"
date: "2020-11-05"
layout: single
tags:
- DFIR
categories:
- Notes
---

Hi, good to see you again.

Let's jump to DFIR thingy where this note may help us in approaching suspected/infected Windows machine in DFIR manner. Here we go.

# Grabbing artifacts

Grabbing artifacts is the first and important stage when it come to digital forensic. I usually will use this three tools.

1. gkape
2. Triage IR
3. Redline Comprehensive

## gkape

Kroll Artifact Parser and Extractor (KAPE) is primarily a triage program that will target a device or storage location, find the most forensically relevant artifacts (based on your needs), and parse them within a few minutes. Because of its speed, KAPE allows investigators to find and prioritize the more critical systems to their case. Additionally, KAPE can be used to collect the most critical artifacts prior to the start of the imaging process. While the imaging completes, the data generated by KAPE can be reviewed for leads, building timelines, etc.

gkape is simple GUI for the KAPE that can help you quickly enumerate all the target and module options. You can choose variety of artifacts options meet your own disire. What you want, and what you not wanted to.

![](https://raw.githubusercontent.com/fareedfauzi/fareedfauzi.github.io/master/assets/images/dfirnote/2020-11-05-13-19-39.png)

## Triage IR

Triage IR is a Scripted collection of system information valuable to a Forensic Analyst. Instead of copying everything, collecting some key files can solve this issue.

IRTriage will collect:

- system information
- network information
- registry hives
- disk information, and
- dump memory.

One of the powerful capabilities of IRTriage is collecting information from "Volume Shadow Copy" which can defeat many anti-forensics techniques.

The IRTriage is itself just an autoit script that depend on other tools such as:

- Win32|64dd (free from Moonsols) or FDpro *(HBGary's commercial product)
- Sysinternals Suite
- The Sleuth Kit
- Regripper
- NirSoft => MFTDump and WinPrefetchView
- md5deep and sha1deep
- CSVFileView
- 7zip
- and some windows built-in commands.

![](https://raw.githubusercontent.com/fareedfauzi/fareedfauzi.github.io/master/assets/images/dfirnote/2020-11-05-13-25-36.png)

Just click `Select All` and hit `Run` then the tool will do his job.

## Redline comprehensive

A Redline Collector package contains an executable script to collect data from a potentially compromised endpoint. 

There are three types of Redline Collectors: 
- Standard Collector,
- Comprehensive Collector, 
- and IOC Search Collector (Windows only).

![](https://raw.githubusercontent.com/fareedfauzi/fareedfauzi.github.io/master/assets/images/dfirnote/2020-11-05-13-29-05.png)

- `Standard Collector` = The Standard Collector configures scripts to gather the minimum amount of data to complete an analysis.
- `Comprehensive Collector` = The Comprehensive Collector configures scripts to gather most of the data that Redline collects and analyzes. Use this type of Redline Collector if you intend to do a full analysis or if you have only one opportunity to collect data from a computer.

For me, just choose the `Comprehensive Collector` as it give us full analysis and juicy info rather than using the `Standard` one.

How to create and run `Comprehensive Collector`?
1. Choose `Create a Comprehensive Collector`
2. Choose `Windows`
3. Check the box `Acquire Memory Image` to dump the memory image.
4. Choose the location of the `Comprehensive Collector` script and files to be save.
5. Copy the folder of the `Comprehensive Collector` to removable media.
6. On the evidence Windows machine you want to audit, run the `RunRedlineAudit.bat` script, preferably from removable media (e.g. a USB Hard Drive).

![](https://raw.githubusercontent.com/fareedfauzi/fareedfauzi.github.io/master/assets/images/dfirnote/2020-11-05-13-37-40.png)



